---
import type { SupportedLanguages } from '@raulmelo/core/config';
import { queryCodeSnippets } from '@raulmelo/core/domains';

import { getIntl } from '@/infrastructure/i18n/getServerSideLocales.server';
import { sanityClient } from '@/infrastructure/sanity/client';
import Layout from '@/ui/layouts/Layout.astro';

const { lang } = Astro.params as { lang: SupportedLanguages };

const intl = getIntl(lang);

const snippets = await queryCodeSnippets({ client: sanityClient });

console.log(snippets);
---

<Layout title="Code Snippets" containerClass="flex flex-col">
  <header class="col-span-full lg:col-span-10">
    <h1 class="text-3xl font-extrabold md:text-4xl">Code Snippets</h1>

    <!-- <p class="my-4 col-span-full lg:col-span-10 text-md md:text-lg">
      {intl.formatMessage({ id: `tags.all.description` })}
    </p> -->
  </header>

  <ul class="space-y-10 col-span-full">
    {
      snippets.map((snippet) => {
        return (
          <li>
            <a href={`/en/snippets/${snippet.slug}`}>
              <h2>{snippet.title}</h2>
              <p>{snippet.description}</p>
            </a>
          </li>
        );
      })
    }
  </ul>
</Layout>
